{"ast":null,"code":"'use strict';\n\nvar encodings = require('./encodings');\n\nvar compileDecode = require('./decode');\n\nvar compileEncode = require('./encode');\n\nvar compileEncodingLength = require('./encoding-length');\n\nvar varint = require('varint');\n\nvar flatten = function (values) {\n  if (!values) return null;\n  var result = {};\n  Object.keys(values).forEach(function (k) {\n    result[k] = values[k].value;\n  });\n  return result;\n};\n\nmodule.exports = function (schema, extraEncodings) {\n  var messages = {};\n  var enums = {};\n  var cache = {};\n\n  var visit = function (schema, prefix) {\n    if (schema.enums) {\n      schema.enums.forEach(function (e) {\n        e.id = prefix + (prefix ? '.' : '') + e.name;\n        enums[e.id] = e;\n        visit(e, e.id);\n      });\n    }\n\n    if (schema.messages) {\n      schema.messages.forEach(function (m) {\n        m.id = prefix + (prefix ? '.' : '') + m.name;\n        messages[m.id] = m;\n        m.fields.forEach(function (f) {\n          if (!f.map) return;\n          var name = 'Map_' + f.map.from + '_' + f.map.to;\n          var map = {\n            name: name,\n            enums: [],\n            messages: [],\n            fields: [{\n              name: 'key',\n              type: f.map.from,\n              tag: 1,\n              repeated: false,\n              required: true\n            }, {\n              name: 'value',\n              type: f.map.to,\n              tag: 2,\n              repeated: false,\n              required: false\n            }],\n            extensions: null,\n            id: prefix + (prefix ? '.' : '') + name\n          };\n\n          if (!messages[map.id]) {\n            messages[map.id] = map;\n            schema.messages.push(map);\n          }\n\n          f.type = name;\n          f.repeated = true;\n        });\n        visit(m, m.id);\n      });\n    }\n  };\n\n  visit(schema, '');\n\n  var compileEnum = function (e) {\n    var values = Object.keys(e.values || []).map(function (k) {\n      return parseInt(e.values[k].value, 10);\n    });\n\n    var encode = function encode(val, buf, offset) {\n      if (!values.length || values.indexOf(val) === -1) {\n        throw new Error('Invalid enum value: ' + val);\n      }\n\n      varint.encode(val, buf, offset);\n      encode.bytes = varint.encode.bytes;\n      return buf;\n    };\n\n    var decode = function decode(buf, offset) {\n      var val = varint.decode(buf, offset);\n\n      if (!values.length || values.indexOf(val) === -1) {\n        throw new Error('Invalid enum value: ' + val);\n      }\n\n      decode.bytes = varint.decode.bytes;\n      return val;\n    };\n\n    return encodings.make(0, encode, decode, varint.encodingLength);\n  };\n\n  var compileMessage = function (m, exports) {\n    m.messages.forEach(function (nested) {\n      exports[nested.name] = resolve(nested.name, m.id);\n    });\n    m.enums.forEach(function (val) {\n      exports[val.name] = flatten(val.values);\n    });\n    exports.type = 2;\n    exports.message = true;\n    exports.name = m.name;\n    var oneofs = {};\n    m.fields.forEach(function (f) {\n      if (!f.oneof) return;\n      if (!oneofs[f.oneof]) oneofs[f.oneof] = [];\n      oneofs[f.oneof].push(f.name);\n    });\n    var enc = m.fields.map(function (f) {\n      return resolve(f.type, m.id);\n    });\n    var encodingLength = compileEncodingLength(m, enc, oneofs);\n    var encode = compileEncode(m, resolve, enc, oneofs, encodingLength);\n    var decode = compileDecode(m, resolve, enc); // end of compilation - return all the things\n\n    encode.bytes = decode.bytes = 0;\n    exports.buffer = true;\n    exports.encode = encode;\n    exports.decode = decode;\n    exports.encodingLength = encodingLength;\n    return exports;\n  };\n\n  var resolve = function (name, from, compile) {\n    if (extraEncodings && extraEncodings[name]) return extraEncodings[name];\n    if (encodings[name]) return encodings[name];\n    var m = (from ? from + '.' + name : name).split('.').map(function (part, i, list) {\n      return list.slice(0, i).concat(name).join('.');\n    }).reverse().reduce(function (result, id) {\n      return result || messages[id] || enums[id];\n    }, null);\n    if (compile === false) return m;\n    if (!m) throw new Error('Could not resolve ' + name);\n    if (m.values) return compileEnum(m);\n    var res = cache[m.id] || compileMessage(m, cache[m.id] = {});\n    return res;\n  };\n\n  return (schema.enums || []).concat((schema.messages || []).map(function (message) {\n    return resolve(message.id);\n  }));\n};","map":{"version":3,"sources":["/home/ranju/location/meDossier/frontend/node_modules/protons/src/compile/index.js"],"names":["encodings","require","compileDecode","compileEncode","compileEncodingLength","varint","flatten","values","result","Object","keys","forEach","k","value","module","exports","schema","extraEncodings","messages","enums","cache","visit","prefix","e","id","name","m","fields","f","map","from","to","type","tag","repeated","required","extensions","push","compileEnum","parseInt","encode","val","buf","offset","length","indexOf","Error","bytes","decode","make","encodingLength","compileMessage","nested","resolve","message","oneofs","oneof","enc","buffer","compile","split","part","i","list","slice","concat","join","reverse","reduce","res"],"mappings":"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","sourcesContent":["'use strict'\n\nvar encodings = require('./encodings')\nvar compileDecode = require('./decode')\nvar compileEncode = require('./encode')\nvar compileEncodingLength = require('./encoding-length')\nvar varint = require('varint')\n\nvar flatten = function (values) {\n  if (!values) return null\n  var result = {}\n  Object.keys(values).forEach(function (k) {\n    result[k] = values[k].value\n  })\n  return result\n}\n\nmodule.exports = function (schema, extraEncodings) {\n  var messages = {}\n  var enums = {}\n  var cache = {}\n\n  var visit = function (schema, prefix) {\n    if (schema.enums) {\n      schema.enums.forEach(function (e) {\n        e.id = prefix + (prefix ? '.' : '') + e.name\n        enums[e.id] = e\n        visit(e, e.id)\n      })\n    }\n    if (schema.messages) {\n      schema.messages.forEach(function (m) {\n        m.id = prefix + (prefix ? '.' : '') + m.name\n        messages[m.id] = m\n        m.fields.forEach(function (f) {\n          if (!f.map) return\n\n          var name = 'Map_' + f.map.from + '_' + f.map.to\n          var map = {\n            name: name,\n            enums: [],\n            messages: [],\n            fields: [{\n              name: 'key',\n              type: f.map.from,\n              tag: 1,\n              repeated: false,\n              required: true\n            }, {\n              name: 'value',\n              type: f.map.to,\n              tag: 2,\n              repeated: false,\n              required: false\n            }],\n            extensions: null,\n            id: prefix + (prefix ? '.' : '') + name\n          }\n\n          if (!messages[map.id]) {\n            messages[map.id] = map\n            schema.messages.push(map)\n          }\n          f.type = name\n          f.repeated = true\n        })\n        visit(m, m.id)\n      })\n    }\n  }\n\n  visit(schema, '')\n\n  var compileEnum = function (e) {\n    var values = Object.keys(e.values || []).map(function (k) {\n      return parseInt(e.values[k].value, 10)\n    })\n\n    var encode = function encode (val, buf, offset) {\n      if (!values.length || values.indexOf(val) === -1) {\n        throw new Error('Invalid enum value: ' + val)\n      }\n      varint.encode(val, buf, offset)\n      encode.bytes = varint.encode.bytes\n      return buf\n    }\n\n    var decode = function decode (buf, offset) {\n      var val = varint.decode(buf, offset)\n      if (!values.length || values.indexOf(val) === -1) {\n        throw new Error('Invalid enum value: ' + val)\n      }\n      decode.bytes = varint.decode.bytes\n      return val\n    }\n\n    return encodings.make(0, encode, decode, varint.encodingLength)\n  }\n\n  var compileMessage = function (m, exports) {\n    m.messages.forEach(function (nested) {\n      exports[nested.name] = resolve(nested.name, m.id)\n    })\n\n    m.enums.forEach(function (val) {\n      exports[val.name] = flatten(val.values)\n    })\n\n    exports.type = 2\n    exports.message = true\n    exports.name = m.name\n\n    var oneofs = {}\n\n    m.fields.forEach(function (f) {\n      if (!f.oneof) return\n      if (!oneofs[f.oneof]) oneofs[f.oneof] = []\n      oneofs[f.oneof].push(f.name)\n    })\n\n    var enc = m.fields.map(function (f) {\n      return resolve(f.type, m.id)\n    })\n\n    var encodingLength = compileEncodingLength(m, enc, oneofs)\n    var encode = compileEncode(m, resolve, enc, oneofs, encodingLength)\n    var decode = compileDecode(m, resolve, enc)\n\n    // end of compilation - return all the things\n\n    encode.bytes = decode.bytes = 0\n\n    exports.buffer = true\n    exports.encode = encode\n    exports.decode = decode\n    exports.encodingLength = encodingLength\n\n    return exports\n  }\n\n  var resolve = function (name, from, compile) {\n    if (extraEncodings && extraEncodings[name]) return extraEncodings[name]\n    if (encodings[name]) return encodings[name]\n\n    var m = (from ? from + '.' + name : name).split('.')\n      .map(function (part, i, list) {\n        return list.slice(0, i).concat(name).join('.')\n      })\n      .reverse()\n      .reduce(function (result, id) {\n        return result || messages[id] || enums[id]\n      }, null)\n\n    if (compile === false) return m\n    if (!m) throw new Error('Could not resolve ' + name)\n\n    if (m.values) return compileEnum(m)\n    var res = cache[m.id] || compileMessage(m, cache[m.id] = {})\n    return res\n  }\n\n  return (schema.enums || []).concat((schema.messages || []).map(function (message) {\n    return resolve(message.id)\n  }))\n}\n"]},"metadata":{},"sourceType":"script"}